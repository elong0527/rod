---
title: "Count"
---

```{python}
#| include: false
import sys
from pathlib import Path

# Add src to path for imports
sys.path.insert(0, 'src')
```

::: callout-tip
## Objective

Add examples to illustrate helper functions to count subject / records"
:::


```{python}
import polars as pl
from csrlite import count_subject, count_subject_with_observation
```

```{python}
adsl = pl.read_parquet("data/adsl.parquet")
adae = pl.read_parquet("data/adae.parquet")
```

# Population 

```{python}
df = count_subject(
    population = adsl, 
    id = "USUBJID", 
    group = "TRT01A",
)
df
```

```{python}
(
    df.
    with_columns(pl.lit("Subjects in Population").alias("label")).
    pivot(index = "label", on = "TRT01A", values = "n_subj_pop")
)
```

# Observation 

```{python}
df = count_subject_with_observation(
    population = adsl, 
    observation = adae,
    id = "USUBJID", 
    group = "TRT01A",
    variable = "AESOC"
)
df
```

```{python}
(
    df
    .pivot(index = "AESOC", on = "TRT01A", values = "n_pct_subj_fmt")
    .sort("AESOC")
)
```